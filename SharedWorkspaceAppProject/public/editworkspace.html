<!-- Name: Course Project - CoWorking Registry Web App
Course Code: SODV1201
Class: Software Development Diploma program.
Author: Nestle Juco, Sheryl Lugti, Lady Rose Alarcon, Aldwin Sean Eje -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <script src="script.js" defer></script>
    <title>SPACESHARE - Your workplace anytime, anywhere</title>
  </head>
  <body>
    
    <!--Quick Links-->
    <div class="quicklinks">
      <div>
        <ul class="qlinkitems">
          <li>
            <i
              class="fa fa-envelope"
              style="font-size: 20px; color: #c7c7c7"
            ></i
            >&nbsp;<a
              href="mailto:info@spaceshare.com"
              title="E-mail Us"
              style="color: #c7c7c7"
              >info@spaceshare.com</a
            >
          </li>
          <li>
            <i class="fa fa-phone" style="font-size: 20px; color: #c7c7c7"></i
            >&nbsp;<a
              href="tel:+18255587624"
              title="Call Us"
              style="color: #c7c7c7"
              >825.558.7624</a
            >
          </li>
          <li>
            <i
              class="fa fa-calendar"
              style="font-size: 20px; color: #c7c7c7"
            ></i
            >&nbsp;Mon - Sun 6:00am - 12:00mn
          </li>
        </ul>
      </div>
      <div>&nbsp;</div>
      <div class="qlinkitems">
        <li>
          <a href="#" title="facebook"
            ><i class="fa fa-facebook" style="font-size: 20px"></i
          ></a>
        </li>
        <li>
          <a href="#" title="linkedin"
            ><i class="fa fa-linkedin" style="font-size: 20px"></i
          ></a>
        </li>
        <li>
          <a href="#" title="twitter"
            ><i class="fa fa-twitter" style="font-size: 20px"></i
          ></a>
        </li>
      </div>
    </div>

    <!--Header-->
    <header>
      <div class="logo">
        <h1 id="h1custom">SPACESHARE - OWNER ADMIN DASHBOARD</h1>
      </div>
      <div>&nbsp;</div>
      <input id="menu-toggle" type="checkbox" />
      <label class="menu-button-container" for="menu-toggle">
        <div class="menu-button"></div>
      </label>
      <ul class="menu">
        <li>
          <a href="owneradmin.html#listproperty" title="List Space">LIST</a>
        </li>
        <li>
          <a href="ownerview.html#viewproperty" title="View Space">VIEW</a>
        </li>
        <li>
          <button class="button button1">
            <a href="index.html" title="Logout" style="color: #cecece">LOGOUT</a>
          </button>
        </li>
      </ul>
    </header>

    <!--Banner Slideshow-->
    <div class="slideshow-container">
      <div class="mySlides">
        <img src="images/banner1.png" style="width: 100%" />
      </div>

      <div class="mySlides">
        <img src="images/banner2.png" style="width: 100%" />
      </div>

      <div class="mySlides">
        <img src="images/banner3.png" style="width: 100%" />
      </div>

      <div class="mySlides">
        <img src="images/banner4.png" style="width: 100%" />
      </div>
    <br />

    <div style="text-align: center">
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="dot"></span>
    </div>

   <!--Main Content-->
    <main>
      <article id="listworkspace">
        <h2 id="h3custom">EDIT WORKSPACE</h2>
        <p style="text-align: left;">Edit the form below to update your Workspace</p>
        <hr />
        <article>
        <img src="images/workspace.png" alt="Workspace" width="100%"/>
        </article>

        <script>
          // get the property id from the URL
           const queryString = window.location.search;
           const urlParams = new URLSearchParams(queryString);
           const workspaceId = urlParams.get('workspaceId');
   
           // fetch the property.json file
           fetch(`http://localhost:8081/workspace/${workspaceId}`, {
             // specify the mode as cors
             mode: "cors",
             // optionally, specify the headers with the origin
             headers: {
               "Access-Control-Allow-Origin": "*",
             },
           })
           // convert the response to a JSON object
           .then((response) => response.json())
           // use the data from the JSON object
           .then((workspace) => {
             // get the property details from the data object
             let workspacePropertyId = workspace.propertyid;
																   
																   
	           let workspaceType = workspace.workspacetype;
             let workspaceAddress = workspace.workspaceaddress;
             let workspaceNeighborhood = workspace.workspaceneighborhood;
             let workspaceSeatingCap = workspace.seatingcapacity;
             let workspaceSmoking = workspace.workspacesmoking;
             let workspaceDateAvail = workspace.workspacedateavailable;
             let workspaceDailyPrice = workspace.workspacedailyprice;
             let workspaceRentStat = workspace.workspacerentstatus;
             let workspaceStatus = workspace.workspacestatus;
             let workspaceContactInfo = workspace.workspacecontactinfo;
             // update the form fields with the workspace details
			  
             document.getElementById("workspaceid").value = workspaceId;
             document.getElementById("propertyid").value = workspacePropertyId;
		 

             if (workspaceType == "Personal Desk") {
              document.getElementById("workspacetype1").checked = true;
             } else if (workspaceType == "Meeting Room") {
              document.getElementById("workspacetype2").checked = true;
             } else{
              document.getElementById("workspacetype3").checked = true;
             }

             document.getElementById("workspaceaddress").value = workspaceAddress;
             document.getElementById("workspaceneighborhood").value = workspaceNeighborhood;
             document.getElementById("seatingcapacity").value = workspaceSeatingCap;

             if (workspaceSmoking == "Allowed") {
              document.getElementById("workspacesmoking1").checked = true;
             } else {
              document.getElementById("workspacesmoking2").checked = true;
             }
             document.getElementById("workspacedateavailable").value = workspaceDateAvail;				
             document.getElementById("workspacedailyprice").value = workspaceDailyPrice;
		 

             if (workspaceRentStat == "Available"){
              document.getElementById("workspacerentstatus1").checked = true;
             } else {
              document.getElementById("workspacerentstatus2").checked = true;
             }

             if (workspaceStatus == "Operational") {
              document.getElementById("workspacestatus1").checked = true;
             } else if (workspaceType == "Temporary Unserviceable") {
              document.getElementById("workspacestatus2").checked = true;
             } else{
              document.getElementById("workspacestatus3").checked = true;;
             }

             document.getElementById("workspacecontactinfo").value = workspaceContactInfo;

             //change the form submission behavior to send a PUT request to correctly update the existing property data when the form is submitted 
             // get a reference to the form element
             const wform = document.getElementById('addWorkSpaceForm');
   
             // add an event listener for the form submit event
             wform.addEventListener('submit', (event) => {
               // prevent the default form submission behavior
               event.preventDefault();
   
               // get the property id from the URL
               const queryString = window.location.search;
               const urlParams = new URLSearchParams(queryString);
               const propertyId = urlParams.get('workspaceid');
   
               // get the form data as an object
               const wformData = Object.fromEntries(new FormData(wform).entries());
   
               // send a PUT request to the server with the updated property details
               fetch(`/workspace/${workspaceId}`, {
                 method: 'PUT',
                 headers: {
                   'Content-Type': 'application/json'
                 },
                 body: JSON.stringify(wformData)
               })
               .then(response => response.json())
               .then(data => {
                 // handle the server response
                 console.log(data);
               });
             });
           });			  
        </script>

          <form id="addWorkSpaceForm" action="/addWorkSpace" method="post"><!--added form id-->
          <table align="center" style="width: 50%;">
            <tr>
              <td style="background-color:#213159; color: #ececec">
                <label for="workspaceid">Workspace ID</label>
              </td>
              <td>
                <input style="font-size: medium;" id="workspaceid" name="workspaceid" readonly />
              </td>
            </tr>

            <tr>
              <td style="background-color:#213159; color: #ececec">
                <label for="propertyid">Property ID</label>
              </td>
              <td>
                <input style="font-size: medium;"  id="propertyid" name="propertyid" readonly/>
              </td>
            </tr>

            <tr>
              <td style="background-color:#213159; color: #ececec">
                <label for="workspacetype">Type</label>
              </td>
              <td>
                <input id="workspacetype1" type="radio" name="workspacetype" value="Personal Desk"/>
                <label for="workspacetype">Personal Desk</label>
                <input id="workspacetype2" type="radio" name="workspacetype" value="Meeting Room"/>
                <label for="workspacetype">Meeting Room</label>
                <input id="workspacetype3" type="radio" name="workspacetype" value="Private Room"/>
                <label for="workspacetype">Private Room</label>
              </td>
            </tr>

            <tr>
              <td style="background-color:#213159; color: #ececec">
                <label for="workspaceaddress">Address</label>
              </td>
              <td>
                <input style="font-size: medium;"  id="workspaceaddress" type="text" name="workspaceaddress" />
              </td>
            </tr>

            <tr>
              <td style="background-color:#213159; color: #ececec">
                <label for="workspaceneighborhood">Neighborhood</label>
              </td>
              <td>
                <input style="font-size: medium;"  id="workspaceneighborhood" type="text" name="workspaceneighborhood" />
              </td>
            </tr>

            <tr>
              <td style="background-color:#213159; color: #ececec">
                <label for="seatingcapacity">Seating Capacity</label>
              </td>
              <td>
                <input style="font-size: medium;" id="seatingcapacity" type="number" name="seatingcapacity" />
              </td>
            </tr>

            <tr>
              <td style="background-color:#213159; color: #ececec">
                <label for="workspacesmoking">Smoking</label>
              </td>
              <td>
                <input id="workspacesmoking1" type="radio" name="workspacesmoking" value="Allowed" />
                <label for="workspacesmoking">Allowed</label>
                <input id="workspacesmoking2" type="radio" name="workspacesmoking" value="Not Allowed" />
                <label for="workspacesmoking">Not Allowed</label>
              </td>
            </tr>

            <tr>
              <td style="background-color:#213159; color: #ececec">
                <label for="workspacedateavailable">Date Available</label>
              </td>
              <td>
                <input style="font-size: medium;" id="workspacedateavailable" type="date" name="workspacedateavailable" />
              </td>
            </tr>

            <tr>
              <td style="background-color:#213159; color: #ececec">
                <label for="workspacedailyprice">Daily Price</label>
              </td>
              <td>
                <input style="font-size: medium;" id="workspacedailyprice" type="number" name="workspacedailyprice" />
              </td>
            </tr>
            
            <tr>
              <td style="background-color:#213159; color: #ececec">
                <label for="workspacerentstatus">Rent Status</label>
              </td>
              <td>
                <input id="workspacerentstatus1" type="radio" name="workspacerentstatus" value="Available" />
                <label for="workspacerentstatus">Available</label>
                <input id="workspacerentstatus2" type="radio" name="workspacerentstatus" value="Booked" />
                <label for="workspacerentstatus">Booked</label>
              </td>
            </tr>
            
            <tr>
              <td style="background-color:#213159; color: #ececec">
                <label for="workspacestatus">Workspace Status</label>
              </td>
              <td>
                <input id="workspacestatus1" type="radio" name="workspacestatus" value="Operational" />
                <label for="workspacestatus">Operational</label>
                <input id="workspacestatus2" type="radio" name="workspacestatus" value="Temporary Unserviceable" />
                <label for="workspacestatus">Temporary Unserviceable</label>
                <input id="workspacestatus3" type="radio" name="workspacestatus" value="Closed" />
                <label for="workspacestatus">Closed</label>
              </td>
            </tr>
            
            <tr>
              <td style="background-color:#213159; color: #ececec">
                <label for="workspacecontactinfo">Contact Information</label>
              </td>
              <td>
                <input style="font-size: medium;" id="workspacecontactinfo" type="number" name="workspacecontactinfo" />
              </td>
            </tr>
          </table>
                <input class="button button1" style="color: #cecece" type="submit" value="UPDATE WORKSPACE" />
          <hr>
        </form>
		<!--Display message under the update button-->
        <div id="update-message"></div>
        <script>
          document.querySelector('#addWorkSpaceForm').addEventListener('submit', function (event) {
            event.preventDefault();
            document.getElementById('update-message').innerHTML = 'Update of Workspace Successful!';
            setTimeout(function () {
              window.location.href = 'http://localhost:8081/ownerview.html#viewproperty';
            }, 2000);
          });
        </script>				
      </article>
    </main>  

    <!--Footer-->
    <footer>
      <p class="pfooter">© 2023 All Rights Reserved. SpaceShare.</p>
    </footer>
  </body>
</html>